ğŸŒ Environment: Local Development
ğŸ“¦ Project: salfagpt
ğŸ”§ Initializing Firestore client...
ğŸ“¦ Project ID: salfagpt
ğŸŒ Environment: local
ğŸ—ï¸  Node ENV: development
âœ… Firestore client initialized successfully
ğŸ’¡ Local dev: Ensure you have run "gcloud auth application-default login"
ğŸ’¡ Production: Uses Workload Identity automatically

ğŸš€ SalfaGPT CLI - Batch Document Upload
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ Configuration:
   ğŸ“ Folder: /Users/alec/salfagpt/upload-queue/M3-v2-20251125
   ğŸ·ï¸  Tag: M3-v2-20251125-fixed
   ğŸ¤– Agent: vStojK73ZKbjNsEnqANJ
   ğŸ‘¤ User: usr_uhwqffaqag1wrryd82tw (alec@getaifactory.com)
   âš¡ Model: gemini-2.5-flash
   ğŸ”‘ Session: cli-upload-1764091462110-ienf49zez

ğŸ“¦ Checking GCS bucket...
âœ… Bucket ready

ğŸ“‚ Scanning folder for PDFs...
âœ… Found 62 PDF files

ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_upload_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: undefined
}
ğŸ“Š [DEV] Would track CLI session: {
  command: 'upload --folder=/Users/alec/salfagpt/upload-queue/M3-v2-20251125 --tag=M3-v2-20251125-fixed --agent=vStojK73ZKbjNsEnqANJ',
  user: 'alec@getaifactory.com',
  duration: undefined,
  events: 62
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 1 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: GOP-D-PI-1.PLANIFICACION INICIAL DE OBRA-(V.1) (1).PDF
ğŸ“Š Progreso global: 0 completados, 62 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-D-PI-1.PLANIFICACION INICIAL DE OBRA-(V.1) (1).PDF
   ğŸ“¤ 13.1% (64.0 KB/488.1 KB) @ 20.83 MB/s   ğŸ“¤ 26.2% (128.0 KB/488.1 KB) @ 17.86 MB/s   ğŸ“¤ 39.3% (192.0 KB/488.1 KB) @ 23.44 MB/s   ğŸ“¤ 52.4% (256.0 KB/488.1 KB) @ 249.0 KB/s   ğŸ“¤ 65.6% (320.0 KB/488.1 KB) @ 311.0 KB/s   ğŸ“¤ 78.7% (384.0 KB/488.1 KB) @ 371.0 KB/s   ğŸ“¤ 91.8% (448.0 KB/488.1 KB) @ 429.1 KB/s   ğŸ“¤ 100.0% (488.1 KB/488.1 KB) @ 466.6 KB/s   âœ… Subido en 2.2s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-D-PI-1.PLANIFICACION INICIAL DE OBRA-(V.1) (1).PDF

   âœ… Upload exitoso en 2.2s (225.4 KB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-D-PI-1.PLANIFICACION INICIAL DE OBRA-(V.1) (1).PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: GOP-D-PI-1.PLANIFICACION INICIAL DE OBRA-(V.1) (1).PDF
   ğŸ“Š TamaÃ±o: 488.08 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/1. PLANIFICACIÃ“N INICIAL DE LA OBRA/GOP-D-PI-1.PLANIFICACION INICIAL DE OBRA-(V.1) (1).PDF
   ğŸ“Š TamaÃ±o: 488.08 KB
   ğŸ”„ Enviando a Gemini AI...
.....................................................................................................................................
   âœ… ExtracciÃ³n completa en 266.7s
   ğŸ“ 1,632,943 caracteres extraÃ­dos
   ğŸ¯ ~408,236 tokens estimados
   ğŸ’° Costo estimado: $0.122526
   ğŸ‘ï¸  Preview: Here is the complete extracted text from the PDF document, processed sequentially from page 1 to the last page, with Markdown formatting for structure and tables.

---

**Page 1**

n
EDIFICACIÃ“N

| 1 ...
   âœ… ExtracciÃ³n exitosa en 266.7s
   ğŸ“ Caracteres extraÃ­dos: 1,632,943
   ğŸ¯ Tokens estimados: ~408,236
   ğŸ“¥ Input tokens: 730
   ğŸ“¤ Output tokens: 408,236
   ğŸ’° Costo: $0.122526
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
   âš ï¸  Large extraction (1,632,943 chars)
   ğŸ“ Storing preview only (100,000 chars) in Firestore
   â„¹ï¸  Full text will be in chunks and BigQuery
   âœ… Documento guardado exitosamente
   ğŸ†” Source ID: aDtoA6sBk4cceHcUkHhU
   â±ï¸  Tiempo: 1.5s

ğŸ§¬ Paso 4/5: Procesando para RAG (chunking + embeddings)...
   ğŸ“Š Texto a procesar: 1,632,943 caracteres
   ğŸ“Š Tokens estimados: ~408,236 tokens

   ğŸ”¬ Paso 4/5: Preparando para RAG (Retrieval-Augmented Generation)... cyan
   ğŸ“ Chunking text (1000 tokens/chunk, 102 token overlap = 10%)...
   âœ… Created 456 chunks (with 102 token overlap)
   ğŸ“Š Average chunk size: 997 tokens
   ğŸ“Š Overlap: 102 tokens (10.2%)
   ğŸ—‘ï¸ Filtered 454 low-quality chunks
   ğŸ—‘ï¸ Filtrados 454 chunks de baja calidad
   âœ… 2 chunks Ãºtiles restantes
   ğŸ§¬ Generating embeddings for 2 chunks...
   ğŸ¤– Model: text-embedding-004
   ğŸ“¦ Batch size: 32 chunks (optimized for throughput)
      ğŸ“¦ Batch 1/1: Processing chunks 1-2...
      âœ… Batch 1 complete: 2 embeddings generated
   âœ… Generated 2 embeddings (768 dimensions each)
   ğŸ“Š Processed in 1 batches
   ğŸ’¾ Storing 2 embeddings in Firestore...
   âœ… Stored 2 chunks in collection 'document_chunks'
   ğŸ“ Collection: https://console.firebase.google.com/project/gen-lang-client-0986191192/firestore/data/~2Fdocument_chunks
   ğŸ“Š Syncing to BigQuery for vector search...
ğŸ“Š BigQuery Vector Search initialized
  Project: salfagpt
  Dataset: flow_rag_optimized
  Table: document_chunks_vectorized
   ğŸ“¤ BigQuery batch 1/1: Syncing 2 chunks...
   âœ… BigQuery batch 1 complete: 2 chunks synced
   âœ… Total synced to BigQuery: 2 chunks
   âœ… Synced 2 chunks to BigQuery
   âœ… Paso 4/5: RAG process completado en 2.0s
      ğŸ“¦ 2 chunks creados
      ğŸ§¬ 2 embeddings generados (768-dim)
      ğŸ¯ 1,616 tokens totales
      ğŸ’° Costo embeddings: $0.000032
   âœ… Chunking completado: 2 chunks creados
   âœ… Embeddings generados: 2 vectores (768 dimensiones)
   ğŸ“Š Promedio tokens/chunk: 808
   ğŸ’° Costo embeddings: $0.000032
   â±ï¸  Tiempo RAG: 2.0s

ğŸ“ Paso 5/5: Actualizando metadata RAG...
   âœ… Metadata actualizada
   ğŸ” RAG enabled: Yes

ğŸ”— Asignando a agente...
   ğŸ¤– Agente: vStojK73ZKbjNsEnqANJ
âœ… Updated conversation vStojK73ZKbjNsEnqANJ with 74 active sources
Error saving conversation context: Error: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp
    at callErrorFromStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/call.ts:84:17)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:360:55)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:466:34)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at <anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/resolving-call.ts:170:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
for call at
    at ServiceClientImpl.makeUnaryRequest (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:325:42)
    at ServiceClientImpl.<anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/make-client.ts:189:15)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/v1/firestore_client.js:242:33
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/timeout.ts:54:13)
    at repeat (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:110:19)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:157:7)
    at OngoingCallPromise.call (/Users/alec/salfagpt/node_modules/google-gax/src/call.ts:81:23)
    at NormalApiCaller.call (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/normalApiCaller.ts:43:15)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/createApiCall.ts:157:26)
Caused by: Error
    at _firestore._traceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:438:27)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30
    at NoopContextManager.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)
    at ContextAPI.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/api/context.ts:77:42)
    at NoopTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)
    at ProxyTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)
    at EnabledTraceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)
    at WriteBatch.commit (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:436:43)
    at saveConversationContext (/Users/alec/salfagpt/src/lib/firestore.ts:1586:19)
    at async uploadSingleFile (/Users/alec/salfagpt/cli/commands/upload.ts:465:5) {
  code: 5,
  details: 'No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp',
  metadata: Metadata {
    internalRepr: Map(1) { 'x-debug-tracking-id' => [Array] },
    opaqueData: Map(0) {},
    options: {}
  },
  note: 'Exception occurred in retry method that was not classified as transient'
}
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: false
}

âŒ GOP-D-PI-1.PLANIFICACION INICIAL DE OBRA-(V.1) (1).PDF failed: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 2 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: 6.5 MAQ-LOG-CBO-P-001 GESTION DE BODEGAS DE OBRAS REV.07.PDF
ğŸ“Š Progreso global: 1 completados, 61 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/6.5 MAQ-LOG-CBO-P-001 GESTION DE BODEGAS DE OBRAS REV.07.PDF
   ğŸ“¤ 9.7% (64.0 KB/661.3 KB) @ 15.63 MB/s   ğŸ“¤ 19.4% (128.0 KB/661.3 KB) @ 13.89 MB/s   ğŸ“¤ 29.0% (192.0 KB/661.3 KB) @ 20.83 MB/s   ğŸ“¤ 38.7% (256.0 KB/661.3 KB) @ 246.4 KB/s   ğŸ“¤ 48.4% (320.0 KB/661.3 KB) @ 308.0 KB/s   ğŸ“¤ 58.1% (384.0 KB/661.3 KB) @ 368.2 KB/s   ğŸ“¤ 67.7% (448.0 KB/661.3 KB) @ 425.5 KB/s   ğŸ“¤ 77.4% (512.0 KB/661.3 KB) @ 485.8 KB/s   ğŸ“¤ 87.1% (576.0 KB/661.3 KB) @ 546.0 KB/s   ğŸ“¤ 96.8% (640.0 KB/661.3 KB) @ 606.1 KB/s   ğŸ“¤ 100.0% (661.3 KB/661.3 KB) @ 625.6 KB/s   âœ… Subido en 2.1s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/6.5 MAQ-LOG-CBO-P-001 GESTION DE BODEGAS DE OBRAS REV.07.PDF

   âœ… Upload exitoso en 2.1s (316.2 KB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/6.5 MAQ-LOG-CBO-P-001 GESTION DE BODEGAS DE OBRAS REV.07.PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: 6.5 MAQ-LOG-CBO-P-001 GESTION DE BODEGAS DE OBRAS REV.07.PDF
   ğŸ“Š TamaÃ±o: 661.28 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/2. PLAN DE CALIDAD Y OPERACIÃ“N DE OBRA/2.1. CALIDAD Y OPERACIÃ“N DE OBRA/6.5 MAQ-LOG-CBO-P-001 GESTION DE BODEGAS DE OBRAS REV.07.PDF
   ğŸ“Š TamaÃ±o: 661.28 KB
   ğŸ”„ Enviando a Gemini AI...
..................................................................................................................................
   âœ… ExtracciÃ³n completa en 260.7s
   ğŸ“ 949,247 caracteres extraÃ­dos
   ğŸ¯ ~237,312 tokens estimados
   ğŸ’° Costo estimado: $0.071262
   ğŸ‘ï¸  Preview: # MAQSAÂ® Abastecimiento y Servicios

| 07 | 27/07/23 | IOA | SAL | ADB | Se recodifica procedimiento, se actualizan Instructivos, Paso a Paso y Registros |
|----|----------|-----|-----|-----|---------...
   âœ… ExtracciÃ³n exitosa en 260.7s
   ğŸ“ Caracteres extraÃ­dos: 949,247
   ğŸ¯ Tokens estimados: ~237,312
   ğŸ“¥ Input tokens: 907
   ğŸ“¤ Output tokens: 237,312
   ğŸ’° Costo: $0.071262
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
   âš ï¸  Large extraction (949,247 chars)
   ğŸ“ Storing preview only (100,000 chars) in Firestore
   â„¹ï¸  Full text will be in chunks and BigQuery
   âœ… Documento guardado exitosamente
   ğŸ†” Source ID: rpFZXvNjMPWaKS3XVf3y
   â±ï¸  Tiempo: 1.4s

ğŸ§¬ Paso 4/5: Procesando para RAG (chunking + embeddings)...
   ğŸ“Š Texto a procesar: 949,247 caracteres
   ğŸ“Š Tokens estimados: ~237,312 tokens

   ğŸ”¬ Paso 4/5: Preparando para RAG (Retrieval-Augmented Generation)... cyan
   ğŸ“ Chunking text (1000 tokens/chunk, 102 token overlap = 10%)...
   âœ… Created 267 chunks (with 102 token overlap)
   ğŸ“Š Average chunk size: 990 tokens
   ğŸ“Š Overlap: 102 tokens (10.2%)
   ğŸ—‘ï¸ Filtered 254 low-quality chunks
   ğŸ—‘ï¸ Filtrados 254 chunks de baja calidad
   âœ… 13 chunks Ãºtiles restantes
   ğŸ§¬ Generating embeddings for 13 chunks...
   ğŸ¤– Model: text-embedding-004
   ğŸ“¦ Batch size: 32 chunks (optimized for throughput)
      ğŸ“¦ Batch 1/1: Processing chunks 1-13...
      âœ… Batch 1 complete: 13 embeddings generated
   âœ… Generated 13 embeddings (768 dimensions each)
   ğŸ“Š Processed in 1 batches
   ğŸ’¾ Storing 13 embeddings in Firestore...
   âœ… Stored 13 chunks in collection 'document_chunks'
   ğŸ“ Collection: https://console.firebase.google.com/project/gen-lang-client-0986191192/firestore/data/~2Fdocument_chunks
   ğŸ“Š Syncing to BigQuery for vector search...
   ğŸ“¤ BigQuery batch 1/1: Syncing 13 chunks...
   âœ… BigQuery batch 1 complete: 13 chunks synced
   âœ… Total synced to BigQuery: 13 chunks
   âœ… Synced 13 chunks to BigQuery
   âœ… Paso 4/5: RAG process completado en 11.9s
      ğŸ“¦ 13 chunks creados
      ğŸ§¬ 13 embeddings generados (768-dim)
      ğŸ¯ 11,802 tokens totales
      ğŸ’° Costo embeddings: $0.000236
   âœ… Chunking completado: 13 chunks creados
   âœ… Embeddings generados: 13 vectores (768 dimensiones)
   ğŸ“Š Promedio tokens/chunk: 908
   ğŸ’° Costo embeddings: $0.000236
   â±ï¸  Tiempo RAG: 11.9s

ğŸ“ Paso 5/5: Actualizando metadata RAG...
   âœ… Metadata actualizada
   ğŸ” RAG enabled: Yes

ğŸ”— Asignando a agente...
   ğŸ¤– Agente: vStojK73ZKbjNsEnqANJ
âœ… Updated conversation vStojK73ZKbjNsEnqANJ with 75 active sources
Error saving conversation context: Error: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp
    at callErrorFromStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/call.ts:84:17)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:360:55)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:466:34)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at <anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/resolving-call.ts:170:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
for call at
    at ServiceClientImpl.makeUnaryRequest (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:325:42)
    at ServiceClientImpl.<anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/make-client.ts:189:15)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/v1/firestore_client.js:242:33
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/timeout.ts:54:13)
    at repeat (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:110:19)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:157:7)
    at OngoingCallPromise.call (/Users/alec/salfagpt/node_modules/google-gax/src/call.ts:81:23)
    at NormalApiCaller.call (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/normalApiCaller.ts:43:15)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/createApiCall.ts:157:26)
Caused by: Error
    at _firestore._traceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:438:27)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30
    at NoopContextManager.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)
    at ContextAPI.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/api/context.ts:77:42)
    at NoopTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)
    at ProxyTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)
    at EnabledTraceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)
    at WriteBatch.commit (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:436:43)
    at saveConversationContext (/Users/alec/salfagpt/src/lib/firestore.ts:1586:19)
    at async uploadSingleFile (/Users/alec/salfagpt/cli/commands/upload.ts:465:5) {
  code: 5,
  details: 'No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp',
  metadata: Metadata {
    internalRepr: Map(1) { 'x-debug-tracking-id' => [Array] },
    opaqueData: Map(0) {},
    options: {}
  },
  note: 'Exception occurred in retry method that was not classified as transient'
}
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: false
}

âŒ 6.5 MAQ-LOG-CBO-P-001 GESTION DE BODEGAS DE OBRAS REV.07.PDF failed: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 3 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: CONTRATACION DE SUBCONTRATISTAS.PDF
ğŸ“Š Progreso global: 2 completados, 60 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/CONTRATACION DE SUBCONTRATISTAS.PDF
   ğŸ“¤ 2.2% (64.0 KB/2.83 MB) @ 31.25 MB/s   ğŸ“¤ 4.4% (128.0 KB/2.83 MB) @ 20.83 MB/s   ğŸ“¤ 6.6% (192.0 KB/2.83 MB) @ 31.25 MB/s   ğŸ“¤ 8.8% (256.0 KB/2.83 MB) @ 996.1 KB/s   ğŸ“¤ 11.1% (320.0 KB/2.83 MB) @ 1.22 MB/s   ğŸ“¤ 13.3% (384.0 KB/2.83 MB) @ 1.43 MB/s   ğŸ“¤ 15.5% (448.0 KB/2.83 MB) @ 1.61 MB/s   ğŸ“¤ 17.7% (512.0 KB/2.83 MB) @ 1.83 MB/s   ğŸ“¤ 19.9% (576.0 KB/2.83 MB) @ 2.02 MB/s   ğŸ“¤ 22.1% (640.0 KB/2.83 MB) @ 2.24 MB/s   ğŸ“¤ 24.3% (704.0 KB/2.83 MB) @ 2.43 MB/s   ğŸ“¤ 26.5% (768.0 KB/2.83 MB) @ 919.8 KB/s   ğŸ“¤ 28.7% (832.0 KB/2.83 MB) @ 995.2 KB/s   ğŸ“¤ 31.0% (896.0 KB/2.83 MB) @ 1.04 MB/s   ğŸ“¤ 33.2% (960.0 KB/2.83 MB) @ 1.12 MB/s   ğŸ“¤ 35.4% (1.00 MB/2.83 MB) @ 1.18 MB/s   ğŸ“¤ 37.6% (1.06 MB/2.83 MB) @ 903.7 KB/s   ğŸ“¤ 39.8% (1.13 MB/2.83 MB) @ 938.9 KB/s   ğŸ“¤ 42.0% (1.19 MB/2.83 MB) @ 869.8 KB/s   ğŸ“¤ 44.2% (1.25 MB/2.83 MB) @ 885.8 KB/s   ğŸ“¤ 46.4% (1.31 MB/2.83 MB) @ 927.5 KB/s   ğŸ“¤ 48.6% (1.38 MB/2.83 MB) @ 855.9 KB/s   ğŸ“¤ 50.8% (1.44 MB/2.83 MB) @ 894.3 KB/s   ğŸ“¤ 53.1% (1.50 MB/2.83 MB) @ 933.2 KB/s   ğŸ“¤ 55.3% (1.56 MB/2.83 MB) @ 971.5 KB/s   ğŸ“¤ 57.5% (1.63 MB/2.83 MB) @ 1010.3 KB/s   ğŸ“¤ 59.7% (1.69 MB/2.83 MB) @ 1.02 MB/s   ğŸ“¤ 61.9% (1.75 MB/2.83 MB) @ 1.06 MB/s   ğŸ“¤ 64.1% (1.81 MB/2.83 MB) @ 1.10 MB/s   ğŸ“¤ 66.3% (1.88 MB/2.83 MB) @ 1.14 MB/s   ğŸ“¤ 68.5% (1.94 MB/2.83 MB) @ 1.17 MB/s   ğŸ“¤ 70.7% (2.00 MB/2.83 MB) @ 1.21 MB/s   ğŸ“¤ 73.0% (2.06 MB/2.83 MB) @ 1.25 MB/s   ğŸ“¤ 75.2% (2.13 MB/2.83 MB) @ 1.29 MB/s   ğŸ“¤ 77.4% (2.19 MB/2.83 MB) @ 1.32 MB/s   ğŸ“¤ 79.6% (2.25 MB/2.83 MB) @ 1.36 MB/s   ğŸ“¤ 81.8% (2.31 MB/2.83 MB) @ 1.40 MB/s   ğŸ“¤ 84.0% (2.38 MB/2.83 MB) @ 1.44 MB/s   ğŸ“¤ 86.2% (2.44 MB/2.83 MB) @ 1.47 MB/s   ğŸ“¤ 88.4% (2.50 MB/2.83 MB) @ 1.51 MB/s   ğŸ“¤ 90.6% (2.56 MB/2.83 MB) @ 1.55 MB/s   ğŸ“¤ 92.9% (2.63 MB/2.83 MB) @ 1.59 MB/s   ğŸ“¤ 95.1% (2.69 MB/2.83 MB) @ 1.62 MB/s   ğŸ“¤ 97.3% (2.75 MB/2.83 MB) @ 1.66 MB/s   ğŸ“¤ 99.5% (2.81 MB/2.83 MB) @ 1.70 MB/s   ğŸ“¤ 100.0% (2.83 MB/2.83 MB) @ 1.71 MB/s   âœ… Subido en 2.5s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/CONTRATACION DE SUBCONTRATISTAS.PDF

   âœ… Upload exitoso en 2.5s (1.12 MB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/CONTRATACION DE SUBCONTRATISTAS.PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: CONTRATACION DE SUBCONTRATISTAS.PDF
   ğŸ“Š TamaÃ±o: 2894.85 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/2. PLAN DE CALIDAD Y OPERACIÃ“N DE OBRA/2.1. CALIDAD Y OPERACIÃ“N DE OBRA/CONTRATACION DE SUBCONTRATISTAS.PDF
   ğŸ“Š TamaÃ±o: 2894.85 KB
   ğŸ”„ Enviando a Gemini AI...
...........................................................
   âœ… ExtracciÃ³n completa en 119.3s
   ğŸ“ 436,823 caracteres extraÃ­dos
   ğŸ¯ ~109,206 tokens estimados
   ğŸ’° Costo estimado: $0.033001
   ğŸ‘ï¸  Preview: The complete text extracted from the PDF document is as follows:

# PROCESO DE CONTRATACIÃ“N DE SUBCONTRATISTAS

Sostenibilidad

| 1   | 02/01/2024 | AUDITORIA INTERNA | CONTRALOR | CONTRALORA | Actual...
   âœ… ExtracciÃ³n exitosa en 119.3s
   ğŸ“ Caracteres extraÃ­dos: 436,823
   ğŸ¯ Tokens estimados: ~109,206
   ğŸ“¥ Input tokens: 3,194
   ğŸ“¤ Output tokens: 109,206
   ğŸ’° Costo: $0.033001
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
   âš ï¸  Large extraction (436,823 chars)
   ğŸ“ Storing preview only (100,000 chars) in Firestore
   â„¹ï¸  Full text will be in chunks and BigQuery
   âœ… Documento guardado exitosamente
   ğŸ†” Source ID: 0RWMnNyew1vXnaoGyNCT
   â±ï¸  Tiempo: 0.6s

ğŸ§¬ Paso 4/5: Procesando para RAG (chunking + embeddings)...
   ğŸ“Š Texto a procesar: 436,823 caracteres
   ğŸ“Š Tokens estimados: ~109,206 tokens

   ğŸ”¬ Paso 4/5: Preparando para RAG (Retrieval-Augmented Generation)... cyan
   ğŸ“ Chunking text (1000 tokens/chunk, 102 token overlap = 10%)...
   âœ… Created 124 chunks (with 102 token overlap)
   ğŸ“Š Average chunk size: 982 tokens
   ğŸ“Š Overlap: 102 tokens (10.2%)
   ğŸ—‘ï¸ Filtered 123 low-quality chunks
   ğŸ—‘ï¸ Filtrados 123 chunks de baja calidad
   âœ… 1 chunks Ãºtiles restantes
   ğŸ§¬ Generating embeddings for 1 chunks...
   ğŸ¤– Model: text-embedding-004
   ğŸ“¦ Batch size: 32 chunks (optimized for throughput)
      ğŸ“¦ Batch 1/1: Processing chunks 1-1...
      âœ… Batch 1 complete: 1 embeddings generated
   âœ… Generated 1 embeddings (768 dimensions each)
   ğŸ“Š Processed in 1 batches
   ğŸ’¾ Storing 1 embeddings in Firestore...
   âœ… Stored 1 chunks in collection 'document_chunks'
   ğŸ“ Collection: https://console.firebase.google.com/project/gen-lang-client-0986191192/firestore/data/~2Fdocument_chunks
   ğŸ“Š Syncing to BigQuery for vector search...
   ğŸ“¤ BigQuery batch 1/1: Syncing 1 chunks...
   âœ… BigQuery batch 1 complete: 1 chunks synced
   âœ… Total synced to BigQuery: 1 chunks
   âœ… Synced 1 chunks to BigQuery
   âœ… Paso 4/5: RAG process completado en 1.0s
      ğŸ“¦ 1 chunks creados
      ğŸ§¬ 1 embeddings generados (768-dim)
      ğŸ¯ 503 tokens totales
      ğŸ’° Costo embeddings: $0.000010
   âœ… Chunking completado: 1 chunks creados
   âœ… Embeddings generados: 1 vectores (768 dimensiones)
   ğŸ“Š Promedio tokens/chunk: 503
   ğŸ’° Costo embeddings: $0.000010
   â±ï¸  Tiempo RAG: 1.0s

ğŸ“ Paso 5/5: Actualizando metadata RAG...
   âœ… Metadata actualizada
   ğŸ” RAG enabled: Yes

ğŸ”— Asignando a agente...
   ğŸ¤– Agente: vStojK73ZKbjNsEnqANJ
âœ… Updated conversation vStojK73ZKbjNsEnqANJ with 76 active sources
Error saving conversation context: Error: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp
    at callErrorFromStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/call.ts:84:17)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:360:55)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:466:34)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at <anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/resolving-call.ts:170:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
for call at
    at ServiceClientImpl.makeUnaryRequest (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:325:42)
    at ServiceClientImpl.<anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/make-client.ts:189:15)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/v1/firestore_client.js:242:33
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/timeout.ts:54:13)
    at repeat (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:110:19)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:157:7)
    at OngoingCallPromise.call (/Users/alec/salfagpt/node_modules/google-gax/src/call.ts:81:23)
    at NormalApiCaller.call (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/normalApiCaller.ts:43:15)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/createApiCall.ts:157:26)
Caused by: Error
    at _firestore._traceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:438:27)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30
    at NoopContextManager.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)
    at ContextAPI.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/api/context.ts:77:42)
    at NoopTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)
    at ProxyTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)
    at EnabledTraceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)
    at WriteBatch.commit (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:436:43)
    at saveConversationContext (/Users/alec/salfagpt/src/lib/firestore.ts:1586:19)
    at async uploadSingleFile (/Users/alec/salfagpt/cli/commands/upload.ts:465:5) {
  code: 5,
  details: 'No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp',
  metadata: Metadata {
    internalRepr: Map(1) { 'x-debug-tracking-id' => [Array] },
    opaqueData: Map(0) {},
    options: {}
  },
  note: 'Exception occurred in retry method that was not classified as transient'
}
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: false
}

âŒ CONTRATACION DE SUBCONTRATISTAS.PDF failed: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 4 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: GOP-P-PCO-2.1.ANEXO RESUMEN REVISIONES MITO-(V.0).PDF
ğŸ“Š Progreso global: 3 completados, 59 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.ANEXO RESUMEN REVISIONES MITO-(V.0).PDF
   ğŸ“¤ 25.4% (64.0 KB/252.0 KB) @ 62.50 MB/s   ğŸ“¤ 50.8% (128.0 KB/252.0 KB) @ 31.25 MB/s   ğŸ“¤ 76.2% (192.0 KB/252.0 KB) @ 46.88 MB/s   ğŸ“¤ 100.0% (252.0 KB/252.0 KB) @ 279.4 KB/s   âœ… Subido en 1.8s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.ANEXO RESUMEN REVISIONES MITO-(V.0).PDF

   âœ… Upload exitoso en 1.8s (142.2 KB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.ANEXO RESUMEN REVISIONES MITO-(V.0).PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: GOP-P-PCO-2.1.ANEXO RESUMEN REVISIONES MITO-(V.0).PDF
   ğŸ“Š TamaÃ±o: 252.04 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/2. PLAN DE CALIDAD Y OPERACIÃ“N DE OBRA/2.1. CALIDAD Y OPERACIÃ“N DE OBRA/GOP-P-PCO-2.1.ANEXO RESUMEN REVISIONES MITO-(V.0).PDF
   ğŸ“Š TamaÃ±o: 252.04 KB
   ğŸ”„ Enviando a Gemini AI...
...........
   âœ… ExtracciÃ³n completa en 23.1s
   ğŸ“ 13,023 caracteres extraÃ­dos
   ğŸ¯ ~3,256 tokens estimados
   ğŸ’° Costo estimado: $0.001013
   ğŸ‘ï¸  Preview: ```markdown
n
EDIFICACIÃ“N

| 0 | 26-07-2024 | GOP | GOP | GOP | ElaboraciÃ³n Documento |
|---|---|---|---|---|---|
| VER | FECHA | ELABORADO | REVISADO | APROBADO | MODIFICACIONES |
| | | | | | GOP-P-P...
   âœ… ExtracciÃ³n exitosa en 23.1s
   ğŸ“ Caracteres extraÃ­dos: 13,023
   ğŸ¯ Tokens estimados: ~3,256
   ğŸ“¥ Input tokens: 488
   ğŸ“¤ Output tokens: 3,256
   ğŸ’° Costo: $0.001013
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
   âœ… Documento guardado exitosamente
   ğŸ†” Source ID: Ir2nF9fBgYJIxuHSOFzy
   â±ï¸  Tiempo: 0.2s

ğŸ§¬ Paso 4/5: Procesando para RAG (chunking + embeddings)...
   ğŸ“Š Texto a procesar: 13,023 caracteres
   ğŸ“Š Tokens estimados: ~3,256 tokens

   ğŸ”¬ Paso 4/5: Preparando para RAG (Retrieval-Augmented Generation)... cyan
   ğŸ“ Chunking text (1000 tokens/chunk, 102 token overlap = 10%)...
   âœ… Created 5 chunks (with 102 token overlap)
   ğŸ“Š Average chunk size: 733 tokens
   ğŸ“Š Overlap: 102 tokens (10.2%)
   ğŸ§¬ Generating embeddings for 5 chunks...
   ğŸ¤– Model: text-embedding-004
   ğŸ“¦ Batch size: 32 chunks (optimized for throughput)
      ğŸ“¦ Batch 1/1: Processing chunks 1-5...
      âœ… Batch 1 complete: 5 embeddings generated
   âœ… Generated 5 embeddings (768 dimensions each)
   ğŸ“Š Processed in 1 batches
   ğŸ’¾ Storing 5 embeddings in Firestore...
   âœ… Stored 5 chunks in collection 'document_chunks'
   ğŸ“ Collection: https://console.firebase.google.com/project/gen-lang-client-0986191192/firestore/data/~2Fdocument_chunks
   ğŸ“Š Syncing to BigQuery for vector search...
   ğŸ“¤ BigQuery batch 1/1: Syncing 5 chunks...
   âœ… BigQuery batch 1 complete: 5 chunks synced
   âœ… Total synced to BigQuery: 5 chunks
   âœ… Synced 5 chunks to BigQuery
   âœ… Paso 4/5: RAG process completado en 4.0s
      ğŸ“¦ 5 chunks creados
      ğŸ§¬ 5 embeddings generados (768-dim)
      ğŸ¯ 3,665 tokens totales
      ğŸ’° Costo embeddings: $0.000073
   âœ… Chunking completado: 5 chunks creados
   âœ… Embeddings generados: 5 vectores (768 dimensiones)
   ğŸ“Š Promedio tokens/chunk: 733
   ğŸ’° Costo embeddings: $0.000073
   â±ï¸  Tiempo RAG: 4.0s

ğŸ“ Paso 5/5: Actualizando metadata RAG...
   âœ… Metadata actualizada
   ğŸ” RAG enabled: Yes

ğŸ”— Asignando a agente...
   ğŸ¤– Agente: vStojK73ZKbjNsEnqANJ
âœ… Updated conversation vStojK73ZKbjNsEnqANJ with 77 active sources
Error saving conversation context: Error: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp
    at callErrorFromStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/call.ts:84:17)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:360:55)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:466:34)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at <anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/resolving-call.ts:170:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
for call at
    at ServiceClientImpl.makeUnaryRequest (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:325:42)
    at ServiceClientImpl.<anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/make-client.ts:189:15)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/v1/firestore_client.js:242:33
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/timeout.ts:54:13)
    at repeat (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:110:19)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:157:7)
    at OngoingCallPromise.call (/Users/alec/salfagpt/node_modules/google-gax/src/call.ts:81:23)
    at NormalApiCaller.call (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/normalApiCaller.ts:43:15)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/createApiCall.ts:157:26)
Caused by: Error
    at _firestore._traceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:438:27)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30
    at NoopContextManager.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)
    at ContextAPI.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/api/context.ts:77:42)
    at NoopTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)
    at ProxyTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)
    at EnabledTraceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)
    at WriteBatch.commit (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:436:43)
    at saveConversationContext (/Users/alec/salfagpt/src/lib/firestore.ts:1586:19)
    at async uploadSingleFile (/Users/alec/salfagpt/cli/commands/upload.ts:465:5) {
  code: 5,
  details: 'No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp',
  metadata: Metadata {
    internalRepr: Map(1) { 'x-debug-tracking-id' => [Array] },
    opaqueData: Map(0) {},
    options: {}
  },
  note: 'Exception occurred in retry method that was not classified as transient'
}
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: false
}

âŒ GOP-P-PCO-2.1.ANEXO RESUMEN REVISIONES MITO-(V.0).PDF failed: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 5 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: GOP-P-PCO-2.1.DETECCION DE HALLAZGOS Y NO CONFORMIDADES-(V.5).PDF
ğŸ“Š Progreso global: 4 completados, 58 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.DETECCION DE HALLAZGOS Y NO CONFORMIDADES-(V.5).PDF
   ğŸ“¤ 36.8% (64.0 KB/174.0 KB) @ 15.63 MB/s   ğŸ“¤ 73.5% (128.0 KB/174.0 KB) @ 17.86 MB/s   ğŸ“¤ 100.0% (174.0 KB/174.0 KB) @ 21.25 MB/s   âœ… Subido en 1.7s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.DETECCION DE HALLAZGOS Y NO CONFORMIDADES-(V.5).PDF

   âœ… Upload exitoso en 1.7s (100.4 KB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.DETECCION DE HALLAZGOS Y NO CONFORMIDADES-(V.5).PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: GOP-P-PCO-2.1.DETECCION DE HALLAZGOS Y NO CONFORMIDADES-(V.5).PDF
   ğŸ“Š TamaÃ±o: 174.04 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/2. PLAN DE CALIDAD Y OPERACIÃ“N DE OBRA/2.1. CALIDAD Y OPERACIÃ“N DE OBRA/GOP-P-PCO-2.1.DETECCION DE HALLAZGOS Y NO CONFORMIDADES-(V.5).PDF
   ğŸ“Š TamaÃ±o: 174.04 KB
   ğŸ”„ Enviando a Gemini AI...
...........
   âœ… ExtracciÃ³n completa en 22.1s
   ğŸ“ 9,687 caracteres extraÃ­dos
   ğŸ¯ ~2,422 tokens estimados
   ğŸ’° Costo estimado: $0.000757
   ğŸ‘ï¸  Preview: The complete text extracted from the PDF document is as follows:

# Page 1

EDIFICACIÃ“N

| 5 | 18-10-24 | GOP | GAG | CO | Se elimina Ã­tem de acciones preventivas |
|---|----------|-----|-----|----|--...
   âœ… ExtracciÃ³n exitosa en 22.1s
   ğŸ“ Caracteres extraÃ­dos: 9,687
   ğŸ¯ Tokens estimados: ~2,422
   ğŸ“¥ Input tokens: 408
   ğŸ“¤ Output tokens: 2,422
   ğŸ’° Costo: $0.000757
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
   âœ… Documento guardado exitosamente
   ğŸ†” Source ID: bITX3iKFXkMphUybiwDs
   â±ï¸  Tiempo: 0.2s

ğŸ§¬ Paso 4/5: Procesando para RAG (chunking + embeddings)...
   ğŸ“Š Texto a procesar: 9,687 caracteres
   ğŸ“Š Tokens estimados: ~2,422 tokens

   ğŸ”¬ Paso 4/5: Preparando para RAG (Retrieval-Augmented Generation)... cyan
   ğŸ“ Chunking text (1000 tokens/chunk, 102 token overlap = 10%)...
   âœ… Created 4 chunks (with 102 token overlap)
   ğŸ“Š Average chunk size: 682 tokens
   ğŸ“Š Overlap: 102 tokens (10.2%)
   ğŸ§¬ Generating embeddings for 4 chunks...
   ğŸ¤– Model: text-embedding-004
   ğŸ“¦ Batch size: 32 chunks (optimized for throughput)
      ğŸ“¦ Batch 1/1: Processing chunks 1-4...
      âœ… Batch 1 complete: 4 embeddings generated
   âœ… Generated 4 embeddings (768 dimensions each)
   ğŸ“Š Processed in 1 batches
   ğŸ’¾ Storing 4 embeddings in Firestore...
   âœ… Stored 4 chunks in collection 'document_chunks'
   ğŸ“ Collection: https://console.firebase.google.com/project/gen-lang-client-0986191192/firestore/data/~2Fdocument_chunks
   ğŸ“Š Syncing to BigQuery for vector search...
   ğŸ“¤ BigQuery batch 1/1: Syncing 4 chunks...
   âœ… BigQuery batch 1 complete: 4 chunks synced
   âœ… Total synced to BigQuery: 4 chunks
   âœ… Synced 4 chunks to BigQuery
   âœ… Paso 4/5: RAG process completado en 3.3s
      ğŸ“¦ 4 chunks creados
      ğŸ§¬ 4 embeddings generados (768-dim)
      ğŸ¯ 2,729 tokens totales
      ğŸ’° Costo embeddings: $0.000055
   âœ… Chunking completado: 4 chunks creados
   âœ… Embeddings generados: 4 vectores (768 dimensiones)
   ğŸ“Š Promedio tokens/chunk: 682
   ğŸ’° Costo embeddings: $0.000055
   â±ï¸  Tiempo RAG: 3.3s

ğŸ“ Paso 5/5: Actualizando metadata RAG...
   âœ… Metadata actualizada
   ğŸ” RAG enabled: Yes

ğŸ”— Asignando a agente...
   ğŸ¤– Agente: vStojK73ZKbjNsEnqANJ
âœ… Updated conversation vStojK73ZKbjNsEnqANJ with 78 active sources
Error saving conversation context: Error: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp
    at callErrorFromStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/call.ts:84:17)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:360:55)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:466:34)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at <anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/resolving-call.ts:170:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
for call at
    at ServiceClientImpl.makeUnaryRequest (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:325:42)
    at ServiceClientImpl.<anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/make-client.ts:189:15)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/v1/firestore_client.js:242:33
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/timeout.ts:54:13)
    at repeat (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:110:19)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:157:7)
    at OngoingCallPromise.call (/Users/alec/salfagpt/node_modules/google-gax/src/call.ts:81:23)
    at NormalApiCaller.call (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/normalApiCaller.ts:43:15)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/createApiCall.ts:157:26)
Caused by: Error
    at _firestore._traceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:438:27)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30
    at NoopContextManager.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)
    at ContextAPI.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/api/context.ts:77:42)
    at NoopTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)
    at ProxyTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)
    at EnabledTraceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)
    at WriteBatch.commit (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:436:43)
    at saveConversationContext (/Users/alec/salfagpt/src/lib/firestore.ts:1586:19)
    at async uploadSingleFile (/Users/alec/salfagpt/cli/commands/upload.ts:465:5) {
  code: 5,
  details: 'No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp',
  metadata: Metadata {
    internalRepr: Map(1) { 'x-debug-tracking-id' => [Array] },
    opaqueData: Map(0) {},
    options: {}
  },
  note: 'Exception occurred in retry method that was not classified as transient'
}
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: false
}

âŒ GOP-P-PCO-2.1.DETECCION DE HALLAZGOS Y NO CONFORMIDADES-(V.5).PDF failed: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 6 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: GOP-P-PCO-2.1.EVALUACION SUBCONTRATOS-(V.0).PDF
ğŸ“Š Progreso global: 5 completados, 57 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.EVALUACION SUBCONTRATOS-(V.0).PDF
   ğŸ“¤ 9.9% (64.0 KB/647.9 KB) @ 15.63 MB/s   ğŸ“¤ 19.8% (128.0 KB/647.9 KB) @ 20.83 MB/s   ğŸ“¤ 29.6% (192.0 KB/647.9 KB) @ 26.79 MB/s   ğŸ“¤ 39.5% (256.0 KB/647.9 KB) @ 252.2 KB/s   ğŸ“¤ 49.4% (320.0 KB/647.9 KB) @ 315.0 KB/s   ğŸ“¤ 59.3% (384.0 KB/647.9 KB) @ 376.5 KB/s   ğŸ“¤ 69.1% (448.0 KB/647.9 KB) @ 435.0 KB/s   ğŸ“¤ 79.0% (512.0 KB/647.9 KB) @ 496.6 KB/s   ğŸ“¤ 88.9% (576.0 KB/647.9 KB) @ 557.6 KB/s   ğŸ“¤ 98.8% (640.0 KB/647.9 KB) @ 619.0 KB/s   ğŸ“¤ 100.0% (647.9 KB/647.9 KB) @ 626.0 KB/s   âœ… Subido en 2.2s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.EVALUACION SUBCONTRATOS-(V.0).PDF

   âœ… Upload exitoso en 2.2s (288.5 KB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.EVALUACION SUBCONTRATOS-(V.0).PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: GOP-P-PCO-2.1.EVALUACION SUBCONTRATOS-(V.0).PDF
   ğŸ“Š TamaÃ±o: 647.92 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/2. PLAN DE CALIDAD Y OPERACIÃ“N DE OBRA/2.1. CALIDAD Y OPERACIÃ“N DE OBRA/GOP-P-PCO-2.1.EVALUACION SUBCONTRATOS-(V.0).PDF
   ğŸ“Š TamaÃ±o: 647.92 KB
   ğŸ”„ Enviando a Gemini AI...
.............
   âœ… ExtracciÃ³n completa en 27.9s
   ğŸ“ 16,154 caracteres extraÃ­dos
   ğŸ¯ ~4,039 tokens estimados
   ğŸ’° Costo estimado: $0.001279
   ğŸ‘ï¸  Preview: Here is the complete extracted text from the PDF document, processed page by page, with clear structure and tables in Markdown format:

---

# Page 1

n
EDIFICACIÃ“N

| 0   | 18-10-2024 | GOP       | G...
   âœ… ExtracciÃ³n exitosa en 27.9s
   ğŸ“ Caracteres extraÃ­dos: 16,154
   ğŸ¯ Tokens estimados: ~4,039
   ğŸ“¥ Input tokens: 893
   ğŸ“¤ Output tokens: 4,039
   ğŸ’° Costo: $0.001279
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
   âœ… Documento guardado exitosamente
   ğŸ†” Source ID: D3EdMGq050axHgGgpf8W
   â±ï¸  Tiempo: 0.2s

ğŸ§¬ Paso 4/5: Procesando para RAG (chunking + embeddings)...
   ğŸ“Š Texto a procesar: 16,154 caracteres
   ğŸ“Š Tokens estimados: ~4,039 tokens

   ğŸ”¬ Paso 4/5: Preparando para RAG (Retrieval-Augmented Generation)... cyan
   ğŸ“ Chunking text (1000 tokens/chunk, 102 token overlap = 10%)...
   âœ… Created 6 chunks (with 102 token overlap)
   ğŸ“Š Average chunk size: 758 tokens
   ğŸ“Š Overlap: 102 tokens (10.2%)
   ğŸ§¬ Generating embeddings for 6 chunks...
   ğŸ¤– Model: text-embedding-004
   ğŸ“¦ Batch size: 32 chunks (optimized for throughput)
      ğŸ“¦ Batch 1/1: Processing chunks 1-6...
      âœ… Batch 1 complete: 6 embeddings generated
   âœ… Generated 6 embeddings (768 dimensions each)
   ğŸ“Š Processed in 1 batches
   ğŸ’¾ Storing 6 embeddings in Firestore...
   âœ… Stored 6 chunks in collection 'document_chunks'
   ğŸ“ Collection: https://console.firebase.google.com/project/gen-lang-client-0986191192/firestore/data/~2Fdocument_chunks
   ğŸ“Š Syncing to BigQuery for vector search...
   ğŸ“¤ BigQuery batch 1/1: Syncing 6 chunks...
   âœ… BigQuery batch 1 complete: 6 chunks synced
   âœ… Total synced to BigQuery: 6 chunks
   âœ… Synced 6 chunks to BigQuery
   âœ… Paso 4/5: RAG process completado en 4.8s
      ğŸ“¦ 6 chunks creados
      ğŸ§¬ 6 embeddings generados (768-dim)
      ğŸ¯ 4,550 tokens totales
      ğŸ’° Costo embeddings: $0.000091
   âœ… Chunking completado: 6 chunks creados
   âœ… Embeddings generados: 6 vectores (768 dimensiones)
   ğŸ“Š Promedio tokens/chunk: 758
   ğŸ’° Costo embeddings: $0.000091
   â±ï¸  Tiempo RAG: 4.8s

ğŸ“ Paso 5/5: Actualizando metadata RAG...
   âœ… Metadata actualizada
   ğŸ” RAG enabled: Yes

ğŸ”— Asignando a agente...
   ğŸ¤– Agente: vStojK73ZKbjNsEnqANJ
âœ… Updated conversation vStojK73ZKbjNsEnqANJ with 79 active sources
Error saving conversation context: Error: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp
    at callErrorFromStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/call.ts:84:17)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:360:55)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:466:34)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at <anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/resolving-call.ts:170:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
for call at
    at ServiceClientImpl.makeUnaryRequest (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:325:42)
    at ServiceClientImpl.<anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/make-client.ts:189:15)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/v1/firestore_client.js:242:33
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/timeout.ts:54:13)
    at repeat (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:110:19)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:157:7)
    at OngoingCallPromise.call (/Users/alec/salfagpt/node_modules/google-gax/src/call.ts:81:23)
    at NormalApiCaller.call (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/normalApiCaller.ts:43:15)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/createApiCall.ts:157:26)
Caused by: Error
    at _firestore._traceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:438:27)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30
    at NoopContextManager.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)
    at ContextAPI.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/api/context.ts:77:42)
    at NoopTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)
    at ProxyTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)
    at EnabledTraceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)
    at WriteBatch.commit (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:436:43)
    at saveConversationContext (/Users/alec/salfagpt/src/lib/firestore.ts:1586:19)
    at async uploadSingleFile (/Users/alec/salfagpt/cli/commands/upload.ts:465:5) {
  code: 5,
  details: 'No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp',
  metadata: Metadata {
    internalRepr: Map(1) { 'x-debug-tracking-id' => [Array] },
    opaqueData: Map(0) {},
    options: {}
  },
  note: 'Exception occurred in retry method that was not classified as transient'
}
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: false
}

âŒ GOP-P-PCO-2.1.EVALUACION SUBCONTRATOS-(V.0).PDF failed: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 7 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: GOP-P-PCO-2.1.INSTRUCTIVO CALCULO DE STOCK CRITICO-(V.0).PDF
ğŸ“Š Progreso global: 6 completados, 56 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.INSTRUCTIVO CALCULO DE STOCK CRITICO-(V.0).PDF
   ğŸ“¤ 18.1% (64.0 KB/354.4 KB) @ 31.25 MB/s   ğŸ“¤ 36.1% (128.0 KB/354.4 KB) @ 25.00 MB/s   ğŸ“¤ 54.2% (192.0 KB/354.4 KB) @ 37.50 MB/s   ğŸ“¤ 72.2% (256.0 KB/354.4 KB) @ 276.2 KB/s   ğŸ“¤ 90.3% (320.0 KB/354.4 KB) @ 344.8 KB/s   ğŸ“¤ 100.0% (354.4 KB/354.4 KB) @ 380.6 KB/s   âœ… Subido en 1.9s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.INSTRUCTIVO CALCULO DE STOCK CRITICO-(V.0).PDF

   âœ… Upload exitoso en 1.9s (187.4 KB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.INSTRUCTIVO CALCULO DE STOCK CRITICO-(V.0).PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: GOP-P-PCO-2.1.INSTRUCTIVO CALCULO DE STOCK CRITICO-(V.0).PDF
   ğŸ“Š TamaÃ±o: 354.37 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/2. PLAN DE CALIDAD Y OPERACIÃ“N DE OBRA/2.1. CALIDAD Y OPERACIÃ“N DE OBRA/GOP-P-PCO-2.1.INSTRUCTIVO CALCULO DE STOCK CRITICO-(V.0).PDF
   ğŸ“Š TamaÃ±o: 354.37 KB
   ğŸ”„ Enviando a Gemini AI...
........
   âœ… ExtracciÃ³n completa en 17.9s
   ğŸ“ 7,892 caracteres extraÃ­dos
   ğŸ¯ ~1,973 tokens estimados
   ğŸ’° Costo estimado: $0.000636
   ğŸ‘ï¸  Preview: Here is the complete extracted text from the PDF document, processed sequentially from page 1 to the last page, with clear structure using Markdown headings and tables in Markdown format.

---

# Page...
   âœ… ExtracciÃ³n exitosa en 17.9s
   ğŸ“ Caracteres extraÃ­dos: 7,892
   ğŸ¯ Tokens estimados: ~1,973
   ğŸ“¥ Input tokens: 593
   ğŸ“¤ Output tokens: 1,973
   ğŸ’° Costo: $0.000636
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
   âœ… Documento guardado exitosamente
   ğŸ†” Source ID: XOgygg4Kljki0gqgWlJB
   â±ï¸  Tiempo: 0.2s

ğŸ§¬ Paso 4/5: Procesando para RAG (chunking + embeddings)...
   ğŸ“Š Texto a procesar: 7,892 caracteres
   ğŸ“Š Tokens estimados: ~1,973 tokens

   ğŸ”¬ Paso 4/5: Preparando para RAG (Retrieval-Augmented Generation)... cyan
   ğŸ“ Chunking text (1000 tokens/chunk, 102 token overlap = 10%)...
   âœ… Created 4 chunks (with 102 token overlap)
   ğŸ“Š Average chunk size: 570 tokens
   ğŸ“Š Overlap: 102 tokens (10.2%)
   ğŸ§¬ Generating embeddings for 4 chunks...
   ğŸ¤– Model: text-embedding-004
   ğŸ“¦ Batch size: 32 chunks (optimized for throughput)
      ğŸ“¦ Batch 1/1: Processing chunks 1-4...
      âœ… Batch 1 complete: 4 embeddings generated
   âœ… Generated 4 embeddings (768 dimensions each)
   ğŸ“Š Processed in 1 batches
   ğŸ’¾ Storing 4 embeddings in Firestore...
   âœ… Stored 4 chunks in collection 'document_chunks'
   ğŸ“ Collection: https://console.firebase.google.com/project/gen-lang-client-0986191192/firestore/data/~2Fdocument_chunks
   ğŸ“Š Syncing to BigQuery for vector search...
   ğŸ“¤ BigQuery batch 1/1: Syncing 4 chunks...
   âœ… BigQuery batch 1 complete: 4 chunks synced
   âœ… Total synced to BigQuery: 4 chunks
   âœ… Synced 4 chunks to BigQuery
   âœ… Paso 4/5: RAG process completado en 2.9s
      ğŸ“¦ 4 chunks creados
      ğŸ§¬ 4 embeddings generados (768-dim)
      ğŸ¯ 2,280 tokens totales
      ğŸ’° Costo embeddings: $0.000046
   âœ… Chunking completado: 4 chunks creados
   âœ… Embeddings generados: 4 vectores (768 dimensiones)
   ğŸ“Š Promedio tokens/chunk: 570
   ğŸ’° Costo embeddings: $0.000046
   â±ï¸  Tiempo RAG: 2.9s

ğŸ“ Paso 5/5: Actualizando metadata RAG...
   âœ… Metadata actualizada
   ğŸ” RAG enabled: Yes

ğŸ”— Asignando a agente...
   ğŸ¤– Agente: vStojK73ZKbjNsEnqANJ
âœ… Updated conversation vStojK73ZKbjNsEnqANJ with 80 active sources
Error saving conversation context: Error: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp
    at callErrorFromStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/call.ts:84:17)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:360:55)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:466:34)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at <anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/resolving-call.ts:170:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
for call at
    at ServiceClientImpl.makeUnaryRequest (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:325:42)
    at ServiceClientImpl.<anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/make-client.ts:189:15)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/v1/firestore_client.js:242:33
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/timeout.ts:54:13)
    at repeat (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:110:19)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:157:7)
    at OngoingCallPromise.call (/Users/alec/salfagpt/node_modules/google-gax/src/call.ts:81:23)
    at NormalApiCaller.call (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/normalApiCaller.ts:43:15)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/createApiCall.ts:157:26)
Caused by: Error
    at _firestore._traceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:438:27)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30
    at NoopContextManager.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)
    at ContextAPI.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/api/context.ts:77:42)
    at NoopTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)
    at ProxyTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)
    at EnabledTraceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)
    at WriteBatch.commit (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:436:43)
    at saveConversationContext (/Users/alec/salfagpt/src/lib/firestore.ts:1586:19)
    at async uploadSingleFile (/Users/alec/salfagpt/cli/commands/upload.ts:465:5) {
  code: 5,
  details: 'No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp',
  metadata: Metadata {
    internalRepr: Map(1) { 'x-debug-tracking-id' => [Array] },
    opaqueData: Map(0) {},
    options: {}
  },
  note: 'Exception occurred in retry method that was not classified as transient'
}
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: false
}

âŒ GOP-P-PCO-2.1.INSTRUCTIVO CALCULO DE STOCK CRITICO-(V.0).PDF failed: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 8 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: GOP-P-PCO-2.1.INSTRUCTIVO MODULADOR DE BODEGAS-(V.0).PDF
ğŸ“Š Progreso global: 7 completados, 55 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.INSTRUCTIVO MODULADOR DE BODEGAS-(V.0).PDF
   ğŸ“¤ 6.2% (64.0 KB/1.01 MB) @ 15.63 MB/s   ğŸ“¤ 12.3% (128.0 KB/1.01 MB) @ 15.63 MB/s   ğŸ“¤ 18.5% (192.0 KB/1.01 MB) @ 20.83 MB/s   ğŸ“¤ 24.6% (256.0 KB/1.01 MB) @ 246.2 KB/s   ğŸ“¤ 30.8% (320.0 KB/1.01 MB) @ 307.7 KB/s   ğŸ“¤ 37.0% (384.0 KB/1.01 MB) @ 367.8 KB/s   ğŸ“¤ 43.1% (448.0 KB/1.01 MB) @ 425.5 KB/s   ğŸ“¤ 49.3% (512.0 KB/1.01 MB) @ 486.2 KB/s   ğŸ“¤ 55.4% (576.0 KB/1.01 MB) @ 546.5 KB/s   ğŸ“¤ 61.6% (640.0 KB/1.01 MB) @ 606.6 KB/s   ğŸ“¤ 67.7% (704.0 KB/1.01 MB) @ 665.4 KB/s   ğŸ“¤ 73.9% (768.0 KB/1.01 MB) @ 725.2 KB/s   ğŸ“¤ 80.1% (832.0 KB/1.01 MB) @ 785.6 KB/s   ğŸ“¤ 86.2% (896.0 KB/1.01 MB) @ 845.3 KB/s   ğŸ“¤ 92.4% (960.0 KB/1.01 MB) @ 905.7 KB/s   ğŸ“¤ 98.5% (1.00 MB/1.01 MB) @ 966.0 KB/s   ğŸ“¤ 100.0% (1.01 MB/1.01 MB) @ 979.5 KB/s   âœ… Subido en 2.4s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.INSTRUCTIVO MODULADOR DE BODEGAS-(V.0).PDF

   âœ… Upload exitoso en 2.4s (428.0 KB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.INSTRUCTIVO MODULADOR DE BODEGAS-(V.0).PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: GOP-P-PCO-2.1.INSTRUCTIVO MODULADOR DE BODEGAS-(V.0).PDF
   ğŸ“Š TamaÃ±o: 1039.24 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/2. PLAN DE CALIDAD Y OPERACIÃ“N DE OBRA/2.1. CALIDAD Y OPERACIÃ“N DE OBRA/GOP-P-PCO-2.1.INSTRUCTIVO MODULADOR DE BODEGAS-(V.0).PDF
   ğŸ“Š TamaÃ±o: 1039.24 KB
   ğŸ”„ Enviando a Gemini AI...
..........................
   âœ… ExtracciÃ³n completa en 52.0s
   ğŸ“ 28,318 caracteres extraÃ­dos
   ğŸ¯ ~7,080 tokens estimados
   ğŸ’° Costo estimado: $0.002221
   ğŸ‘ï¸  Preview: Here is the complete extracted text from the PDF document, processed sequentially from beginning to end, with clear structure using Markdown headings and tables.

---

# Page 1

## n
## EDIFICACIÃ“N

|...
   âœ… ExtracciÃ³n exitosa en 52.0s
   ğŸ“ Caracteres extraÃ­dos: 28,318
   ğŸ¯ Tokens estimados: ~7,080
   ğŸ“¥ Input tokens: 1,294
   ğŸ“¤ Output tokens: 7,080
   ğŸ’° Costo: $0.002221
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
   âœ… Documento guardado exitosamente
   ğŸ†” Source ID: kQneXoIYhicHHpQ74iOj
   â±ï¸  Tiempo: 0.2s

ğŸ§¬ Paso 4/5: Procesando para RAG (chunking + embeddings)...
   ğŸ“Š Texto a procesar: 28,318 caracteres
   ğŸ“Š Tokens estimados: ~7,080 tokens

   ğŸ”¬ Paso 4/5: Preparando para RAG (Retrieval-Augmented Generation)... cyan
   ğŸ“ Chunking text (1000 tokens/chunk, 102 token overlap = 10%)...
   âœ… Created 10 chunks (with 102 token overlap)
   ğŸ“Š Average chunk size: 800 tokens
   ğŸ“Š Overlap: 102 tokens (10.2%)
   ğŸ§¬ Generating embeddings for 10 chunks...
   ğŸ¤– Model: text-embedding-004
   ğŸ“¦ Batch size: 32 chunks (optimized for throughput)
      ğŸ“¦ Batch 1/1: Processing chunks 1-10...
      âœ… Batch 1 complete: 10 embeddings generated
   âœ… Generated 10 embeddings (768 dimensions each)
   ğŸ“Š Processed in 1 batches
   ğŸ’¾ Storing 10 embeddings in Firestore...
   âœ… Stored 10 chunks in collection 'document_chunks'
   ğŸ“ Collection: https://console.firebase.google.com/project/gen-lang-client-0986191192/firestore/data/~2Fdocument_chunks
   ğŸ“Š Syncing to BigQuery for vector search...
   ğŸ“¤ BigQuery batch 1/1: Syncing 10 chunks...
   âœ… BigQuery batch 1 complete: 10 chunks synced
   âœ… Total synced to BigQuery: 10 chunks
   âœ… Synced 10 chunks to BigQuery
   âœ… Paso 4/5: RAG process completado en 7.8s
      ğŸ“¦ 10 chunks creados
      ğŸ§¬ 10 embeddings generados (768-dim)
      ğŸ¯ 8,001 tokens totales
      ğŸ’° Costo embeddings: $0.000160
   âœ… Chunking completado: 10 chunks creados
   âœ… Embeddings generados: 10 vectores (768 dimensiones)
   ğŸ“Š Promedio tokens/chunk: 800
   ğŸ’° Costo embeddings: $0.000160
   â±ï¸  Tiempo RAG: 7.8s

ğŸ“ Paso 5/5: Actualizando metadata RAG...
   âœ… Metadata actualizada
   ğŸ” RAG enabled: Yes

ğŸ”— Asignando a agente...
   ğŸ¤– Agente: vStojK73ZKbjNsEnqANJ
âœ… Updated conversation vStojK73ZKbjNsEnqANJ with 81 active sources
Error saving conversation context: Error: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp
    at callErrorFromStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/call.ts:84:17)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:360:55)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:466:34)
    at Object.onReceiveStatus (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client-interceptors.ts:424:48)
    at <anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/resolving-call.ts:170:24)
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
for call at
    at ServiceClientImpl.makeUnaryRequest (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/client.ts:325:42)
    at ServiceClientImpl.<anonymous> (/Users/alec/salfagpt/node_modules/@grpc/grpc-js/src/make-client.ts:189:15)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/v1/firestore_client.js:242:33
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/timeout.ts:54:13)
    at repeat (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:110:19)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/retries.ts:157:7)
    at OngoingCallPromise.call (/Users/alec/salfagpt/node_modules/google-gax/src/call.ts:81:23)
    at NormalApiCaller.call (/Users/alec/salfagpt/node_modules/google-gax/src/normalCalls/normalApiCaller.ts:43:15)
    at <anonymous> (/Users/alec/salfagpt/node_modules/google-gax/src/createApiCall.ts:157:26)
Caused by: Error
    at _firestore._traceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:438:27)
    at /Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:110:30
    at NoopContextManager.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/context/NoopContextManager.ts:31:15)
    at ContextAPI.with (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/api/context.ts:77:42)
    at NoopTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/NoopTracer.ts:98:27)
    at ProxyTracer.startActiveSpan (/Users/alec/salfagpt/node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts:51:20)
    at EnabledTraceUtil.startActiveSpan (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/telemetry/enabled-trace-util.js:102:28)
    at WriteBatch.commit (/Users/alec/salfagpt/node_modules/@google-cloud/firestore/build/src/write-batch.js:436:43)
    at saveConversationContext (/Users/alec/salfagpt/src/lib/firestore.ts:1586:19)
    at async uploadSingleFile (/Users/alec/salfagpt/cli/commands/upload.ts:465:5) {
  code: 5,
  details: 'No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp',
  metadata: Metadata {
    internalRepr: Map(1) { 'x-debug-tracking-id' => [Array] },
    opaqueData: Map(0) {},
    options: {}
  },
  note: 'Exception occurred in retry method that was not classified as transient'
}
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_failed',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: false
}

âŒ GOP-P-PCO-2.1.INSTRUCTIVO MODULADOR DE BODEGAS-(V.0).PDF failed: 5 NOT_FOUND: No document to update: projects/salfagpt/databases/(default)/documents/context_sources/1EnH6gTnM6a33W4aUeNp

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“„ ARCHIVO 9 de 62
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ Archivo: GOP-P-PCO-2.1.MATRIZ DE OBJETIVOS DE CONTROL DE OBRA-(V.0).PDF
ğŸ“Š Progreso global: 8 completados, 54 restantes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¤ Paso 1/5: Subiendo a Cloud Storage...
   ğŸ“¤ Subiendo a GCS: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.MATRIZ DE OBJETIVOS DE CONTROL DE OBRA-(V.0).PDF
   ğŸ“¤ 21.1% (64.0 KB/303.4 KB) @ 10.42 MB/s   ğŸ“¤ 42.2% (128.0 KB/303.4 KB) @ 12.50 MB/s   ğŸ“¤ 63.3% (192.0 KB/303.4 KB) @ 17.05 MB/s   ğŸ“¤ 84.4% (256.0 KB/303.4 KB) @ 246.6 KB/s   ğŸ“¤ 100.0% (303.4 KB/303.4 KB) @ 292.0 KB/s   âœ… Subido en 2.0s: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.MATRIZ DE OBJETIVOS DE CONTROL DE OBRA-(V.0).PDF

   âœ… Upload exitoso en 2.0s (153.5 KB/s)
   ğŸ“ GCS Path: gs://salfagpt-context-documents/usr_uhwqffaqag1wrryd82tw/vStojK73ZKbjNsEnqANJ/GOP-P-PCO-2.1.MATRIZ DE OBJETIVOS DE CONTROL DE OBRA-(V.0).PDF
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_uploaded',
  user: 'alec@getaifactory.com',
  operation: 'upload',
  success: true
}

ğŸ¤– Paso 2/5: Extrayendo contenido con Gemini AI...
   ğŸ“„ Archivo: GOP-P-PCO-2.1.MATRIZ DE OBJETIVOS DE CONTROL DE OBRA-(V.0).PDF
   ğŸ“Š TamaÃ±o: 303.42 KB
   ğŸ¤– Modelo: gemini-2.5-flash
   â³ Procesando con Gemini...
   ğŸ¤– Extrayendo con gemini-2.5-flash...
   ğŸ“„ Leyendo archivo: /Users/alec/salfagpt/upload-queue/M3-v2-20251125/DOCUMENTOS PORTAL EDIFICACIÃ“N/Primera carga de documentacion/2. PLAN DE CALIDAD Y OPERACIÃ“N DE OBRA/2.1. CALIDAD Y OPERACIÃ“N DE OBRA/GOP-P-PCO-2.1.MATRIZ DE OBJETIVOS DE CONTROL DE OBRA-(V.0).PDF
   ğŸ“Š TamaÃ±o: 303.42 KB
   ğŸ”„ Enviando a Gemini AI...
...........
   âœ… ExtracciÃ³n completa en 23.5s
   ğŸ“ 3,539 caracteres extraÃ­dos
   ğŸ¯ ~885 tokens estimados
   ğŸ’° Costo estimado: $0.000306
   ğŸ‘ï¸  Preview: # Document Header

**EDIFICACIÃ“N**

**MATRIZ DE OBJETIVOS DE CONTROL DE OBRA**

**GOP-P-PCO-2.1.**
**VersiÃ³n:** 0
**Date:** 13-05-2024

# Extracted Table

| NÂ° | OBJETIVO | UNIDAD QUE CONTROLA | INDIC...
   âœ… ExtracciÃ³n exitosa en 23.5s
   ğŸ“ Caracteres extraÃ­dos: 3,539
   ğŸ¯ Tokens estimados: ~885
   ğŸ“¥ Input tokens: 541
   ğŸ“¤ Output tokens: 885
   ğŸ’° Costo: $0.000306
ğŸ“Š [DEV] Would track CLI event: {
  type: 'cli_file_extracted',
  user: 'alec@getaifactory.com',
  operation: 'extract',
  success: true
}

ğŸ’¾ Paso 3/5: Guardando en Firestore...
   ğŸ“¦ Collection: context_sources
   ğŸ·ï¸  Tags: [M3-v2-20251125-fixed]
   ğŸ¤– Assigned to: vStojK73ZKbjNsEnqANJ
